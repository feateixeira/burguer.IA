# üîê Como Configurar Admin no Supabase

## Problema Atual
- Email: `fellipe_1693@outlook.com`
- Erro: "Invalid login credentials"
- Precisa: Acesso admin para gerenciar usu√°rios

---

## ‚úÖ SOLU√á√ÉO COMPLETA

### PASSO 1: Verificar/Criar o Usu√°rio

**Op√ß√£o A - Se o usu√°rio J√Å existe:**

1. Acesse **Supabase Dashboard** ‚Üí **Authentication** ‚Üí **Users**
2. Procure por `fellipe_1693@outlook.com`
3. Se encontrar: clique nele e **"Send password reset email"** ou defina uma nova senha

**Op√ß√£o B - Se o usu√°rio N√ÉO existe:**

1. V√° em **Authentication** ‚Üí **Users** ‚Üí **Add User**
2. Preencha:
   - **Email**: `fellipe_1693@outlook.com`
   - **Password**: (defina uma senha forte)
   - **Auto Confirm User**: ‚úÖ (marcado)
3. Clique em **Create user**

---

### PASSO 2: Configurar como Admin (SQL Editor)

1. No Supabase Dashboard, v√° em **SQL Editor**
2. Execute este script completo:

```sql
-- ============================================
-- CONFIGURAR ADMIN: fellipe_1693@outlook.com
-- ============================================

-- 1. Primeiro, verificar se o usu√°rio existe
SELECT 
  id,
  email,
  confirmed_at,
  created_at
FROM auth.users 
WHERE email = 'fellipe_1693@outlook.com';

-- 2. Criar/Atualizar o profile como ADMIN
-- Nota: A tabela profiles N√ÉO tem coluna 'email', o email fica em auth.users
INSERT INTO public.profiles (user_id, full_name, is_admin, status)
SELECT 
  u.id,
  COALESCE(u.raw_user_meta_data->>'name', 'Administrador') as full_name,
  true as is_admin,
  'active' as status
FROM auth.users u
WHERE u.email = 'fellipe_1693@outlook.com'
ON CONFLICT (user_id) 
DO UPDATE SET 
  is_admin = true,
  status = 'active',
  full_name = COALESCE(EXCLUDED.full_name, profiles.full_name, 'Administrador');

-- 3. Verificar se foi aplicado corretamente
SELECT 
  u.email,
  u.confirmed_at as "Email Confirmado",
  p.full_name as "Nome",
  p.is_admin as "√â Admin?",
  p.status as "Status"
FROM auth.users u
LEFT JOIN public.profiles p ON p.user_id = u.id
WHERE u.email = 'fellipe_1693@outlook.com';
```

---

### PASSO 3: Se precisar resetar a senha

**M√©todo 1 - Via Dashboard:**
- Authentication ‚Üí Users ‚Üí Selecionar `fellipe_1693@outlook.com`
- Clique em "Send password reset email" ou "Reset password"

**M√©todo 2 - Via SQL (se tiver Service Role):**
```sql
-- Nota: Isso requer permiss√µes de service role
-- Geralmente √© feito pelo Dashboard mesmo
```

---

### PASSO 4: Testar o Login

1. V√° para a p√°gina de login do seu sistema
2. Clique na aba **"Admin"**
3. Digite:
   - **Email**: `fellipe_1693@outlook.com`
   - **Senha**: (a senha que voc√™ definiu)
4. Deve redirecionar para `/admin`

---

## ‚ö†Ô∏è POSS√çVEIS PROBLEMAS

### Problema 1: "Usu√°rio n√£o encontrado" no SQL
**Solu√ß√£o**: Crie o usu√°rio primeiro pelo Dashboard (PASSO 1 - Op√ß√£o B)

### Problema 2: "Invalid login credentials" depois de criar
**Solu√ß√µes**:
- Verifique se marcou "Auto Confirm User"
- Verifique se a senha est√° correta
- Tente fazer "Reset Password" no Dashboard

### Problema 3: Login funciona mas n√£o vai para /admin
**Solu√ß√£o**: Execute o SQL do PASSO 2 novamente para garantir `is_admin = true`

### Problema 4: Profile n√£o existe
**Solu√ß√£o**: O SQL do PASSO 2 cria o profile automaticamente. Se n√£o criar, pode ser RLS. Nesse caso, desabilite temporariamente RLS na tabela `profiles` ou use service role.

---

## üîç VERIFICA√á√ÉO FINAL

Execute este SQL para verificar tudo:

```sql
-- Status completo do usu√°rio admin
SELECT 
  u.id as "User ID",
  u.email as "Email",
  u.confirmed_at as "Confirmado?",
  u.created_at as "Criado em",
  p.user_id as "Profile existe?",
  p.is_admin as "√â Admin?",
  p.status as "Status",
  p.full_name as "Nome",
  p.establishment_id as "Estabelecimento"
FROM auth.users u
LEFT JOIN public.profiles p ON p.user_id = u.id
WHERE u.email = 'fellipe_1693@outlook.com';
```

**Resultado esperado**:
- ‚úÖ `confirmed_at` n√£o deve ser NULL
- ‚úÖ `is_admin` deve ser `true`
- ‚úÖ `status` deve ser `'active'`

---

## üìù PR√ìXIMOS PASSOS AP√ìS CONSEGUIR ACESSO

Uma vez logado como admin, voc√™ poder√°:

1. **Ver todos os usu√°rios**: Lista completa na p√°gina `/admin`
2. **Criar novos usu√°rios**: Bot√£o "Criar Usu√°rio" no painel admin
3. **Gerenciar status**: Ativar, bloquear ou cancelar usu√°rios
4. **Enviar notifica√ß√µes**: Como lembretes de pagamento
5. **Conceder dias de teste**: Para novos clientes

---

## üí° DICA

Se continuar com problemas, verifique:
- Se o email est√° escrito exatamente: `fellipe_1693@outlook.com` (sem espa√ßos)
- Se o usu√°rio est√° confirmado (`confirmed_at` n√£o √© NULL)
- Se h√° pol√≠ticas RLS bloqueando (RLS pode impedir cria√ß√£o de profiles)

