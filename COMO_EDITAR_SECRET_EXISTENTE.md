# üîß Como Atualizar um Secret Existente no Supabase

## Problema
Voc√™ j√° tem uma vari√°vel `SUPABASE_SERVICE_ROLE_KEY` configurada, mas precisa atualizar o valor. **N√£o h√° bot√£o de editar** - voc√™ precisa adicionar novamente com o mesmo nome.

## ‚úÖ Solu√ß√£o: Sobrescrever o Secret Existente

### Passo a Passo:

1. **Acesse o Supabase Dashboard:**
   - V√° para https://supabase.com/dashboard
   - Selecione seu projeto

2. **Navegue at√© a Edge Function:**
   - No menu lateral, clique em **Edge Functions**
   - Clique na fun√ß√£o **`create-user`**
   - V√° na aba **Settings** ou procure por **Secrets**

3. **Na se√ß√£o "ADD NEW SECRETS" (parte superior da p√°gina):**
   - No campo **Key**: Digite `SERVICE_ROLE_KEY`
     - ‚ö†Ô∏è **IMPORTANTE**: O Supabase n√£o permite prefixo `SUPABASE_` em secrets
     - Se voc√™ tinha `SUPABASE_SERVICE_ROLE_KEY`, exclua-a e crie uma nova com nome `SERVICE_ROLE_KEY`
   - No campo **Value**: Cole a key correta:
     ```
     eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRuZGl3anpuaXRudWFsdG9yYnBrIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MTY3NTI3NSwiZXhwIjoyMDc3MjUxMjc1fQ.OqXrm_90XLULLN1m7-vVjrWA_yMo2cCCAxwNd6j2DVQ
     ```
   - Clique no bot√£o verde **"Save"**

4. **O Supabase vai automaticamente:**
   - Sobrescrever o valor antigo com o novo
   - Reimplantar a Edge Function
   - Voc√™ ver√° o timestamp "UPDATED AT" mudar na lista

5. **Aguarde e Teste:**
   - Aguarde 10-20 segundos
   - Tente criar um usu√°rio no Admin Panel

### Op√ß√£o 2: Via Supabase CLI (Se tiver instalado)

```bash
# Listar secrets atuais
supabase secrets list

# Atualizar o secret
supabase secrets set SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRuZGl3anpuaXRudWFsdG9yYnBrIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MTY3NTI3NSwiZXhwIjoyMDc3MjUxMjc1fQ.OqXrm_90XLULLN1m7-vVjrWA_yMo2cCCAxwNd6j2DVQ

# Fazer deploy novamente
supabase functions deploy create-user
```

### Op√ß√£o 3: Criar com Nome Diferente (Se n√£o conseguir editar)

Se realmente n√£o conseguir editar a vari√°vel existente, voc√™ pode:

1. Criar uma nova vari√°vel com nome diferente (ex: `SUPABASE_SERVICE_KEY`)
2. Eu atualizo o c√≥digo para aceitar ambos os nomes

## üîç Como Verificar se Est√° Funcionando

1. Ap√≥s editar o secret, aguarde 10-20 segundos
2. Tente criar um usu√°rio no Admin Panel
3. Se ainda der erro, verifique os logs:
   - Edge Functions ‚Üí `create-user` ‚Üí **Logs**
   - Procure por mensagens de erro recentes

## ‚ö†Ô∏è Notas Importantes

- A vari√°vel deve ter o nome **exato**: `SUPABASE_SERVICE_ROLE_KEY` (case-sensitive)
- O valor deve ser a **service_role key completa** (come√ßa com `eyJ...`)
- Ap√≥s editar, pode levar alguns segundos para a fun√ß√£o ser atualizada
- Se n√£o funcionar, verifique se copiou a key completa (sem espa√ßos extras)

