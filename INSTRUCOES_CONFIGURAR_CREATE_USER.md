# Instru√ß√µes para Configurar a Edge Function create-user

## Erro Atual
O erro indica que a vari√°vel de ambiente `SUPABASE_SERVICE_ROLE_KEY` n√£o est√° configurada na Edge Function.

## Solu√ß√£o: Configurar o Secret

### Passo 1: Obter a Service Role Key
1. Acesse o **Supabase Dashboard**: https://supabase.com/dashboard
2. Selecione seu projeto
3. V√° em **Settings** ‚Üí **API**
4. Copie a **`service_role` key** (n√£o use a `anon` key!)
   - ‚ö†Ô∏è **IMPORTANTE**: Esta key tem permiss√µes totais. Mantenha-a segura e n√£o a compartilhe.

### Passo 2: Configurar o Secret na Edge Function
1. No **Supabase Dashboard**, v√° em **Edge Functions** (no menu lateral)
2. Clique na fun√ß√£o **`create-user`**
3. V√° na aba **Settings** ou **Secrets**
4. Clique em **Add new secret** ou **New Secret**
5. Configure:
   - **Nome**: `SUPABASE_SERVICE_ROLE_KEY`
   - **Valor**: Cole a `service_role` key que voc√™ copiou no Passo 1
6. Clique em **Save** ou **Add**

### Passo 3: Verificar a Configura√ß√£o
1. Ap√≥s adicionar o secret, a Edge Function ser√° automaticamente reimplantada
2. Aguarde alguns segundos
3. Tente criar um usu√°rio novamente no Admin Panel

### Passo 4: Verificar Logs (se ainda houver erro)
1. Na p√°gina da Edge Function `create-user`, v√° na aba **Logs**
2. Tente criar um usu√°rio novamente
3. Verifique os logs para ver se h√° outros erros

## Notas Importantes

- ‚ö†Ô∏è A `service_role` key tem **acesso total** ao banco de dados, ignorando RLS policies
- üîí **NUNCA** exponha esta key no c√≥digo frontend ou em reposit√≥rios p√∫blicos
- ‚úÖ Edge Functions s√£o o lugar seguro para usar esta key
- üîÑ Ap√≥s adicionar o secret, pode levar alguns segundos para a fun√ß√£o ser atualizada

## Verifica√ß√£o R√°pida

Se voc√™ usar a CLI do Supabase localmente, tamb√©m pode verificar os secrets:
```bash
supabase secrets list
```

Para adicionar via CLI:
```bash
supabase secrets set SUPABASE_SERVICE_ROLE_KEY=sua_service_role_key_aqui
```

